var C=(i,e)=>()=>(e||(e={exports:{}},i(e.exports,e)),e.exports);var N=C(S=>{S.quote=function(i){return i.map(function(e){return e&&typeof e=="object"?e.op.replace(/(.)/g,"\\$1"):/["\s]/.test(e)&&!/'/.test(e)?"'"+e.replace(/(['\\])/g,"\\$1")+"'":/["'\s]/.test(e)?'"'+e.replace(/(["\\$`!])/g,"\\$1")+'"':String(e).replace(/([A-z]:)?([#!"$&'()*,:;<=>?@\[\\\]^`{|}])/g,"$1\\$2")}).join(" ")};var T="(?:"+["\\|\\|","\\&\\&",";;","\\|\\&","\\<\\(",">>",">\\&","[&;()|<>]"].join("|")+")",D="|&;()<> \\t",j=`(\\\\['"`+D+`]|[^\\s'"`+D+"])+",B='"((\\\\"|[^"])*?)"',z="'((\\\\'|[^'])*?)'",h="";for(var R=0;R<4;R++)h+=(Math.pow(16,8)*Math.random()).toString(16);S.parse=function(i,e,u){var r=I(i,e,u);return typeof e!="function"?r:r.reduce(function(n,a){if(typeof a=="object")return n.concat(a);var c=a.split(RegExp("("+h+".*?"+h+")","g"));return c.length===1?n.concat(c[0]):n.concat(c.filter(Boolean).map(function(t){return RegExp("^"+h).test(t)?JSON.parse(t.split(h)[1]):t}))},[])};function I(i,e,u){var r=new RegExp(["("+T+")","("+j+"|"+B+"|"+z+")*"].join("|"),"g"),n=i.match(r).filter(Boolean),a=!1;if(!n)return[];return e||(e={}),u||(u={}),n.map(function(t,l){if(a)return;if(RegExp("^"+T+"$").test(t))return{op:t};for(var g="'",d='"',x="$",b=u.escape||"\\",m=!1,A=!1,f="",O=!1,o=0,_=t.length;o<_;o++){var s=t.charAt(o);if(O=O||!m&&(s==="*"||s==="?"),A)f+=s,A=!1;else if(m)s===m?m=!1:m==g?f+=s:s===b?(o+=1,s=t.charAt(o),s===d||s===b||s===x?f+=s:f+=b+s):s===x?f+=q():f+=s;else if(s===d||s===g)m=s;else{if(RegExp("^"+T+"$").test(s))return{op:t};if(RegExp("^#$").test(s))return a=!0,f.length?[f,{comment:t.slice(o+1)+n.slice(l+1).join(" ")}]:[{comment:t.slice(o+1)+n.slice(l+1).join(" ")}];s===b?A=!0:s===x?f+=q():f+=s}}if(O)return{op:"glob",pattern:f};return f;function q(){o+=1;var p,v;if(t.charAt(o)==="{"){if(o+=1,t.charAt(o)==="}")throw new Error("Bad substitution: "+t.substr(o-2,3));if(p=t.indexOf("}",o),p<0)throw new Error("Bad substitution: "+t.substr(o));v=t.substr(o,p-o),o=p}else/[*@#?$!_\-]/.test(t.charAt(o))?(v=t.charAt(o),o+=1):(p=t.substr(o).match(/[^\w\d_]/),p?(v=t.substr(o,p.index),o+=p.index-1):(v=t.substr(o),o=t.length));return c(null,"",v)}}).reduce(function(t,l){return l===void 0?t:t.concat(l)},[]);function c(t,l,g){var d=typeof e=="function"?e(g):e[g];return d===void 0&&g!=""?d="":d===void 0&&(d="$"),typeof d=="object"?l+h+JSON.stringify(d)+h:l+d}}});var P=C((Z,M)=>{var E=N().quote,Q=require("util").promisify(require("child_process").exec),w=require("vscode");function k(i,e){let u=new Set(e.toLowerCase().split("")),r=i.toLowerCase().split(/[^A-Za-z0-9_]/),n=a=>a.split("").filter(c=>u.has(c)).length;return r.sort((a,c)=>n(c)-n(a))[0]}function U(i,e){return i.trim().split(`
`).map(r=>{let[n,a]=r.split("	"),c=k(a,e),t=a.toLowerCase().indexOf(c),l=t+c.length;return{number:n,content:a,matching:{start:t,end:l,selection:new w.Selection(new w.Position(n-1,t),new w.Position(n-1,l))}}})}function F(i,e){let u=i.isDirty,r=i.uri.scheme==="file";if(u||!r){let c=i.getText(),t=E([c]).replaceAll("\\\\n","\\\\\\n"),l=E([e]);return`echo ${t} | nl -ba | fzf -f ${l} | head -100`}let n=E([i.uri.path]),a=E([e]);return`cat ${n} | nl -ba | fzf -f ${a} | head -100`}function V(i){if(i.length===0)return Promise.resolve([]);let e=w.window.activeTextEditor.document,u=F(e,i);return Q(u).then(({stdout:r,stderr:n})=>n?(w.window.showErrorMessage(n),Promise.resolve()):r?U(r,i):null)}M.exports=function(e){return V(e).then(u=>u.map((r,n)=>({label:e,description:`- ${r.number}: ${r.content}`,picked:n===0,line:r})))}});var $=require("vscode"),y=P(),W="Please input your search pattern.",L="",G={FIND:"go-to-fuzzy.find"};function J(i){let e=$.commands.registerCommand(G.FIND,()=>y(L).then(u=>{let r=$.window.createQuickPick();Object.assign(r,{value:L,placeholder:W,items:u}),r.onDidChangeValue(n=>{n.length!==0&&y(n).then(a=>{r.items=a})}),r.onDidChangeActive(([n])=>{if(!n)return;let a=n.line.matching.selection;$.window.activeTextEditor.selections=[a],$.window.activeTextEditor.revealRange(a,2)}),r.onDidAccept(n=>r.hide()),r.show()}));i.subscriptions.push(e)}function H(){}module.exports={activate:J,deactivate:H};
